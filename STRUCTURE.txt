enterprise-microservice-system/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                              # Complete documentation
â”œâ”€â”€ ğŸ“„ EXAMPLES.md                            # API usage examples
â”œâ”€â”€ ğŸ“„ PROJECT_SUMMARY.md                     # Project overview
â”œâ”€â”€ ğŸ“„ go.mod                                 # Go module definition
â”œâ”€â”€ ğŸ“„ go.sum                                 # Dependency checksums
â”œâ”€â”€ ğŸ“„ Makefile                               # Build automation
â”œâ”€â”€ ğŸ“„ docker-compose.yml                     # Container orchestration
â”œâ”€â”€ ğŸ“„ .env                                   # Local environment config
â”œâ”€â”€ ğŸ“„ .env.example                           # Environment template
â”œâ”€â”€ ğŸ“„ .gitignore                             # Git ignore rules
â”‚
â”œâ”€â”€ ğŸ“ common/                                # Shared libraries
â”‚   â”œâ”€â”€ ğŸ“ circuitbreaker/
â”‚   â”‚   â””â”€â”€ circuitbreaker.go                # Circuit breaker implementation
â”‚   â”œâ”€â”€ ğŸ“ errors/
â”‚   â”‚   â””â”€â”€ errors.go                        # Custom error types
â”‚   â”œâ”€â”€ ğŸ“ logger/
â”‚   â”‚   â””â”€â”€ logger.go                        # Structured logging (Zap)
â”‚   â”œâ”€â”€ ğŸ“ metrics/
â”‚   â”‚   â””â”€â”€ metrics.go                       # Prometheus metrics
â”‚   â”œâ”€â”€ ğŸ“ middleware/
â”‚   â”‚   â”œâ”€â”€ cors.go                          # CORS handling
â”‚   â”‚   â”œâ”€â”€ logger.go                        # Request logging
â”‚   â”‚   â”œâ”€â”€ rate_limiter.go                  # Token bucket rate limiter
â”‚   â”‚   â”œâ”€â”€ rate_limiter_test.go            # Rate limiter tests
â”‚   â”‚   â”œâ”€â”€ recovery.go                      # Panic recovery
â”‚   â”‚   â””â”€â”€ request_id.go                    # Request ID tracking
â”‚   â””â”€â”€ ğŸ“ response/
â”‚       â””â”€â”€ response.go                      # Standard API responses
â”‚
â”œâ”€â”€ ğŸ“ services/
â”‚   â”œâ”€â”€ ğŸ“ user-service/                     # User Management Service (8081)
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ Dockerfile                    # Container definition
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ .air.toml                     # Hot reload config
â”‚   â”‚   â”œâ”€â”€ ğŸ“ cmd/
â”‚   â”‚   â”‚   â””â”€â”€ main.go                      # Service entry point
â”‚   â”‚   â”œâ”€â”€ ğŸ“ internal/
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ api/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ router.go               # HTTP routes setup
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ config/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ config.go               # Configuration management
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ handler/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user_handler.go         # HTTP request handlers
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ model/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user.go                 # Domain models & DTOs
â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“ repository/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user_repository.go      # Database operations
â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“ service/
â”‚   â”‚   â”‚       â””â”€â”€ user_service.go         # Business logic
â”‚   â”‚   â””â”€â”€ ğŸ“ tests/
â”‚   â”‚       â””â”€â”€ user_service_test.go        # Unit tests
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ order-service/                    # Order Management Service (8082)
â”‚       â”œâ”€â”€ ğŸ“„ Dockerfile                    # Container definition
â”‚       â”œâ”€â”€ ğŸ“„ .air.toml                     # Hot reload config
â”‚       â”œâ”€â”€ ğŸ“ cmd/
â”‚       â”‚   â””â”€â”€ main.go                      # Service entry point
â”‚       â””â”€â”€ ğŸ“ internal/
â”‚           â”œâ”€â”€ ğŸ“ api/
â”‚           â”‚   â””â”€â”€ router.go               # HTTP routes setup
â”‚           â”œâ”€â”€ ğŸ“ client/
â”‚           â”‚   â””â”€â”€ user_client.go          # User service client (w/ circuit breaker)
â”‚           â”œâ”€â”€ ğŸ“ config/
â”‚           â”‚   â””â”€â”€ config.go               # Configuration management
â”‚           â”œâ”€â”€ ğŸ“ handler/
â”‚           â”‚   â””â”€â”€ order_handler.go        # HTTP request handlers
â”‚           â”œâ”€â”€ ğŸ“ model/
â”‚           â”‚   â””â”€â”€ order.go                # Domain models & DTOs
â”‚           â”œâ”€â”€ ğŸ“ repository/
â”‚           â”‚   â””â”€â”€ order_repository.go     # Database operations
â”‚           â””â”€â”€ ğŸ“ service/
â”‚               â””â”€â”€ order_service.go        # Business logic
â”‚
â”‚   â””â”€â”€ ğŸ“ audit-log-service/                # Audit Log Service (8083)
â”‚       â”œâ”€â”€ ğŸ“„ Dockerfile                    # Container definition
â”‚       â”œâ”€â”€ ğŸ“„ .air.toml                     # Hot reload config
â”‚       â”œâ”€â”€ ğŸ“ cmd/
â”‚       â”‚   â””â”€â”€ main.go                      # Service entry point
â”‚       â””â”€â”€ ğŸ“ internal/
â”‚           â”œâ”€â”€ ğŸ“ api/
â”‚           â”‚   â””â”€â”€ router.go               # HTTP routes setup
â”‚           â”œâ”€â”€ ğŸ“ config/
â”‚           â”‚   â””â”€â”€ config.go               # Configuration management
â”‚           â”œâ”€â”€ ğŸ“ handler/
â”‚           â”‚   â””â”€â”€ audit_log_handler.go    # HTTP request handlers
â”‚           â”œâ”€â”€ ğŸ“ model/
â”‚           â”‚   â””â”€â”€ audit_log.go            # Domain models & DTOs
â”‚           â”œâ”€â”€ ğŸ“ repository/
â”‚           â”‚   â””â”€â”€ audit_log_repository.go # Database operations
â”‚           â””â”€â”€ ğŸ“ service/
â”‚               â””â”€â”€ audit_log_service.go    # Business logic
â”‚
â”œâ”€â”€ ğŸ“ monitoring/
â”‚   â””â”€â”€ prometheus.yml                       # Prometheus configuration
â”‚
â””â”€â”€ ğŸ“ bin/                                  # Built binaries (gitignored)
    â”œâ”€â”€ user-service                         # User service binary
    â””â”€â”€ order-service                        # Order service binary

SERVICES ARCHITECTURE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Client/Browser                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  User Service  â”‚  â”‚ Order Service  â”‚  â”‚ Audit Log Service   â”‚
    â”‚   Port: 8081   â”‚â—„â”€â”¤   Port: 8082   â”‚  â”‚   Port: 8083         â”‚
    â”‚                â”‚  â”‚                â”‚  â”‚                     â”‚
    â”‚ - CRUD Users   â”‚  â”‚ - CRUD Orders  â”‚  â”‚ - CRUD Audit Logs    â”‚
    â”‚ - Validation   â”‚  â”‚ - User Lookup  â”‚  â”‚ - Compliance         â”‚
    â”‚ - Pagination   â”‚  â”‚ - Circuit Breakâ”‚  â”‚ - Search             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                  â”‚                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  PostgreSQL    â”‚
                   â”‚    (appdb)     â”‚
                   â”‚   Port: 5432   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MIDDLEWARE STACK (Applied to every request):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. CORS Middleware                    â”‚ â† Allow cross-origin
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Request ID Middleware              â”‚ â† Generate UUID
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Recovery Middleware                â”‚ â† Panic handling
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. Logger Middleware                  â”‚ â† Request logging
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5. Metrics Middleware                 â”‚ â† Prometheus tracking
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  6. Rate Limiter Middleware            â”‚ â† Token bucket
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  7. Handler                            â”‚ â† Business logic
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CIRCUIT BREAKER STATES:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Failure Rate >= 50%   â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ CLOSED  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ OPEN â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”¬â”€â”€â”˜
     â”‚         â–²                       â”‚
     â”‚         â”‚                       â”‚ After Timeout (30s)
     â”‚         â”‚ Success               â”‚
     â”‚         â”‚                       â–¼
     â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â””â”€â”€â”€â”€â”¤ HALF-OPEN â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ Max 3 requests
             â”‚ All succeed â†’ CLOSED
             â”‚ Any fail â†’ OPEN
             â–¼

KEY PATTERNS IMPLEMENTED:
âœ“ Clean Architecture (Transport â†’ Service â†’ Repository)
âœ“ Repository Pattern (Data access abstraction)
âœ“ Dependency Injection (Constructor-based)
âœ“ Circuit Breaker (Resilience pattern)
âœ“ Rate Limiting (Token bucket algorithm)
âœ“ Request-Response Pattern (Synchronous HTTP)
âœ“ Database per Service (Microservice pattern)
âœ“ Graceful Shutdown (Signal handling)
âœ“ Health Check Pattern (Monitoring)
âœ“ Structured Logging (Observability)
âœ“ Metrics Collection (Prometheus)
âœ“ Error Handling (Custom errors with codes)
âœ“ Pagination Pattern (Cursor/offset based)
âœ“ Soft Delete (Data retention)
âœ“ Connection Pooling (Resource management)

TECHNOLOGY BREAKDOWN:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Category       â”‚ Technology                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Language       â”‚ Go 1.23                            â”‚
â”‚ HTTP Framework â”‚ Gin (High performance)             â”‚
â”‚ ORM            â”‚ GORM (Type-safe queries)           â”‚
â”‚ Database       â”‚ PostgreSQL 16                      â”‚
â”‚ Logging        â”‚ Zap (Structured JSON)              â”‚
â”‚ Metrics        â”‚ Prometheus (Time-series DB)        â”‚
â”‚ Circuit Breakerâ”‚ gobreaker (Sony)                   â”‚
â”‚ Rate Limiting  â”‚ golang.org/x/time/rate             â”‚
â”‚ Config         â”‚ godotenv (Environment)             â”‚
â”‚ Testing        â”‚ Go testing + testify               â”‚
â”‚ Containerizationâ”‚ Docker + Docker Compose           â”‚
â”‚ Hot Reload     â”‚ Air                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

OBSERVABILITY ENDPOINTS:
GET /health                â†’ Service health status
GET /metrics               â†’ Prometheus metrics

METRICS COLLECTED:
- {service}_requests_total{method,path,status}
- {service}_request_duration_seconds{method,path}
- {service}_errors_total{type}
- {service}_circuit_breaker_state{service}

ENVIRONMENT VARIABLES (39 total):
User Service (9):
- USER_SERVICE_PORT
- USER_SERVICE_DB_HOST
- USER_SERVICE_DB_PORT
- USER_SERVICE_DB_USER
- USER_SERVICE_DB_PASSWORD
- USER_SERVICE_DB_NAME
- USER_SERVICE_LOG_LEVEL
- USER_SERVICE_RATE_LIMIT

Order Service (10):
- ORDER_SERVICE_PORT
- ORDER_SERVICE_DB_HOST
- ORDER_SERVICE_DB_PORT
- ORDER_SERVICE_DB_USER
- ORDER_SERVICE_DB_PASSWORD
- ORDER_SERVICE_DB_NAME
- ORDER_SERVICE_LOG_LEVEL
- ORDER_SERVICE_RATE_LIMIT
- ORDER_SERVICE_USER_SERVICE_URL

Circuit Breaker (3):
- CIRCUIT_BREAKER_MAX_REQUESTS
- CIRCUIT_BREAKER_INTERVAL
- CIRCUIT_BREAKER_TIMEOUT

MAKEFILE COMMANDS:
make help          â†’ Show all commands
make build         â†’ Build all services
make run           â†’ Run all services
make run-user      â†’ Run user service
make run-order     â†’ Run order service
make test          â†’ Run all tests
make test-user     â†’ Run user service tests
make test-order    â†’ Run order service tests
make lint          â†’ Run linter
make docker-up     â†’ Start Docker containers
make docker-down   â†’ Stop Docker containers
make docker-clean  â†’ Remove all Docker resources
make clean         â†’ Clean build artifacts
make deps          â†’ Download dependencies
make dev-user      â†’ Hot reload user service
make dev-order     â†’ Hot reload order service
make format        â†’ Format code
make vet           â†’ Run go vet

DOCKER CONTAINERS:
- user-service    (Go application)
- order-service   (Go application)
- user-db         (PostgreSQL 16)
- order-db        (PostgreSQL 16)
- prometheus      (Metrics collection)

PORTS:
8081 â†’ User Service HTTP API
8082 â†’ Order Service HTTP API
5432 â†’ User Database (PostgreSQL)
5433 â†’ Order Database (PostgreSQL)
9090 â†’ Prometheus Dashboard

API VERSIONING:
All APIs are versioned: /api/v1/*

RESPONSE FORMAT:
Success:
{
  "success": true,
  "data": {...},
  "meta": {
    "page": 1,
    "page_size": 10,
    "total_pages": 5,
    "total_count": 50
  }
}

Error:
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "Human readable message"
  }
}

This structure follows Go best practices:
- cmd/ for main applications
- internal/ for private application code
- pkg/ would be used for public libraries
- Flat structure within services
- Clear separation of concerns
